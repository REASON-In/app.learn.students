<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Timetable Example</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  .timetable-input { width: 150px; margin: 5px; }
  #timetable-container { margin-top: 20px; }
</style>
</head>
<body>

<h2>School Timetable</h2>

<div id="auth-section">
  <input id="email" placeholder="Email" type="email" /><br />
  <input id="password" placeholder="Password" type="password" /><br />
  <button id="signup-btn">Sign Up</button>
  <button id="login-btn">Log In</button>
  <button id="logout-btn" style="display:none;">Log Out</button>
</div>

<div id="timetable-container" style="display:none;">
  <h3>Edit Timetable</h3>
  <table border="1" cellpadding="5">
    <thead>
      <tr><th>Day</th><th>Period 1</th><th>Period 2</th><th>Period 3</th><th>Period 4</th><th>Period 5</th></tr>
    </thead>
    <tbody>
      <tr>
        <td>Mon</td>
        <td><input type="text" class="timetable-input" data-day="Mon" data-period="1" /></td>
        <td><input type="text" class="timetable-input" data-day="Mon" data-period="2" /></td>
        <td><input type="text" class="timetable-input" data-day="Mon" data-period="3" /></td>
        <td><input type="text" class="timetable-input" data-day="Mon" data-period="4" /></td>
        <td><input type="text" class="timetable-input" data-day="Mon" data-period="5" /></td>
      </tr>
      <tr>
        <td>Tue</td>
        <td><input type="text" class="timetable-input" data-day="Tue" data-period="1" /></td>
        <td><input type="text" class="timetable-input" data-day="Tue" data-period="2" /></td>
        <td><input type="text" class="timetable-input" data-day="Tue" data-period="3" /></td>
        <td><input type="text" class="timetable-input" data-day="Tue" data-period="4" /></td>
        <td><input type="text" class="timetable-input" data-day="Tue" data-period="5" /></td>
      </tr>
      <tr>
        <td>Wed</td>
        <td><input type="text" class="timetable-input" data-day="Wed" data-period="1" /></td>
        <td><input type="text" class="timetable-input" data-day="Wed" data-period="2" /></td>
        <td><input type="text" class="timetable-input" data-day="Wed" data-period="3" /></td>
        <td><input type="text" class="timetable-input" data-day="Wed" data-period="4" /></td>
        <td><input type="text" class="timetable-input" data-day="Wed" data-period="5" /></td>
      </tr>
      <tr>
        <td>Thu</td>
        <td><input type="text" class="timetable-input" data-day="Thu" data-period="1" /></td>
        <td><input type="text" class="timetable-input" data-day="Thu" data-period="2" /></td>
        <td><input type="text" class="timetable-input" data-day="Thu" data-period="3" /></td>
        <td><input type="text" class="timetable-input" data-day="Thu" data-period="4" /></td>
        <td><input type="text" class="timetable-input" data-day="Thu" data-period="5" /></td>
      </tr>
      <tr>
        <td>Fri</td>
        <td><input type="text" class="timetable-input" data-day="Fri" data-period="1" /></td>
        <td><input type="text" class="timetable-input" data-day="Fri" data-period="2" /></td>
        <td><input type="text" class="timetable-input" data-day="Fri" data-period="3" /></td>
        <td><input type="text" class="timetable-input" data-day="Fri" data-period="4" /></td>
        <td><input type="text" class="timetable-input" data-day="Fri" data-period="5" /></td>
      </tr>
    </tbody>
  </table>
  <button id="save-timetable-btn">Save Timetable</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAHSxenlPZD8veD-iZ6pJIOVRbuTD2dw0Q",
    authDomain: "learn-3f43b.firebaseapp.com",
    databaseURL: "https://learn-3f43b-default-rtdb.firebaseio.com",
    projectId: "learn-3f43b",
    storageBucket: "learn-3f43b.firebasestorage.app",
    messagingSenderId: "54412751232",
    appId: "1:54412751232:web:31fe8e2f8b5cc03d409165",
    measurementId: "G-7HRKXL1EPS"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();

  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const signupBtn = document.getElementById('signup-btn');
  const loginBtn = document.getElementById('login-btn');
  const logoutBtn = document.getElementById('logout-btn');
  const timetableContainer = document.getElementById('timetable-container');
  const saveTimetableBtn = document.getElementById('save-timetable-btn');

  signupBtn.onclick = () => {
    const email = emailInput.value.trim();
    const pass = passwordInput.value.trim();
    if (!email || !pass) return alert('Email and password required');
    auth.createUserWithEmailAndPassword(email, pass)
      .then(() => alert('Signed up!'))
      .catch(e => alert('Error: ' + e.message));
  };

  loginBtn.onclick = () => {
    const email = emailInput.value.trim();
    const pass = passwordInput.value.trim();
    if (!email || !pass) return alert('Email and password required');
    auth.signInWithEmailAndPassword(email, pass)
      .catch(e => alert('Error: ' + e.message));
  };

  logoutBtn.onclick = () => {
    auth.signOut();
  };

  auth.onAuthStateChanged(user => {
    if (user) {
      emailInput.style.display = 'none';
      passwordInput.style.display = 'none';
      signupBtn.style.display = 'none';
      loginBtn.style.display = 'none';
      logoutBtn.style.display = 'inline-block';
      timetableContainer.style.display = 'block';
      loadTimetable();
    } else {
      emailInput.style.display = 'inline-block';
      passwordInput.style.display = 'inline-block';
      signupBtn.style.display = 'inline-block';
      loginBtn.style.display = 'inline-block';
      logoutBtn.style.display = 'none';
      timetableContainer.style.display = 'none';
      clearTimetableInputs();
    }
  });

  saveTimetableBtn.onclick = () => {
    saveTimetable();
  };

  function saveTimetable() {
    const user = auth.currentUser;
    if (!user) return alert('Not logged in');

    const timetableData = {};
    document.querySelectorAll('.timetable-input').forEach(input => {
      const day = input.dataset.day;
      const period = input.dataset.period;
      if (!timetableData[day]) timetableData[day] = {};
      timetableData[day][period] = input.value.trim();
    });

    db.ref('timetables/' + user.uid).set(timetableData)
      .then(() => alert('Timetable saved!'))
      .catch(e => alert('Error saving timetable: ' + e.message));
  }

  function loadTimetable() {
    const user = auth.currentUser;
    if (!user) return;

    db.ref('timetables/' + user.uid).get()
      .then(snapshot => {
        if (!snapshot.exists()) {
          clearTimetableInputs();
          return;
        }
        const data = snapshot.val();
        document.querySelectorAll('.timetable-input').forEach(input => {
          const day = input.dataset.day;
          const period = input.dataset.period;
          input.value = data[day] && data[day][period] ? data[day][period] : '';
        });
      })
      .catch(e => {
        alert('Error loading timetable: ' + e.message);
      });
  }

  function clearTimetableInputs() {
    document.querySelectorAll('.timetable-input').forEach(input => input.value = '');
  }
</script>

</body>
</html>
